{% extends "layouts/base.html" %}
{% load static %}

{% block title %}{{ _("Emotional Analytic") }}{% endblock %}

{% block extrastyle %}
  <link href="{% static 'vendor/virtual-select/dist/virtual-select.min.css' %}" rel="stylesheet">

  <style>
    #employee-select {max-width: 100%; }
  </style>
{% endblock extrastyle %}

{% block content %}
<section class="mb-4">
  <div class="card">
    <div class="card-header py-3">
      <h5 class="mb-0 text-center"><strong>{{ _("Emotional Analytic") }}</strong></h5>
    </div>
    <div class="card-body">
      <!-- Pills navs -->
      <ul class="nav nav-pills nav-justified mb-3" id="ex1" role="tablist">
        <li class="nav-item" role="presentation">
          <a data-mdb-pill-init class="nav-link active" id="ex3-tab-1"
            href="#ex3-pills-1" role="tab" aria-controls="ex3-pills-1" aria-selected="true">
            <i class="fas fa-people-arrows fa-fw me-2"></i>{{ _("Work area") }}</a></a>
        </li>
        <li class="nav-item" role="presentation">
          <a data-mdb-pill-init class="nav-link" id="ex3-tab-2"
            href="#ex3-pills-2" role="tab" aria-controls="ex3-pills-2" aria-selected="false">
            <i class="fas fa-user-clock fa-fw me-2"></i>{{ _("Work shift") }}</a></a>
        </li>
        <li class="nav-item" role="presentation">
          <a data-mdb-pill-init class="nav-link" id="ex3-tab-3"
            href="#ex3-pills-3" role="tab" aria-controls="ex3-pills-3" aria-selected="false">
            <i class="fas fa-clock fa-fw me-2"></i>{{ _("Date and Hour") }}</a></a>
        </li>
        <li class="nav-item" role="presentation">
          <a data-mdb-pill-init class="nav-link" id="ex3-tab-4"
            href="#ex3-pills-4" role="tab" aria-controls="ex3-pills-4" aria-selected="false">
            <i class="fas fa-users fa-fw me-2"></i>{{ _("Employees") }}</a>
        </li>
      </ul>
      <!-- Pills navs -->

      <!-- Pills content -->
      <div class="tab-content" id="ex2-content">
        <div class="tab-pane fade show active" id="ex3-pills-1"
          role="tabpanel" aria-labelledby="ex3-tab-1">

          {# EMOCIONES POR √ÅREA #}
          <div class="row mb-3">
            <div class="col-md-4 d-flex align-items-center">
              <div class="col">
                <label for="areaFilter" class="col-form-label me-2"><b style="color: #dc3545;">{{ _("Select worker area") }}:</b></label>
                <select id="areaFilter" class="form-control form-select" required>
                  <option value="" selected>---------</option>
                  {% for area in areas %}
                    <option value="{{ area }}">{{ area }}</option>
                  {% endfor %}
                </select>
              </div>
            </div>

            <div class="col-md-6 d-flex align-items-center">
              <div class="col">
                <label for="range" class="col-form-label me-2"><b style="color: #dc3545;">{{ _("Select date range") }}:</b></label>
                <div id="range" class="input-group">
                  <span class="input-group-text">Desde:</span>
                  <input type="date" name="start" class="form-control" />
                  <span class="input-group-text">Hasta:</span>
                  <input type="date" name="end" class="form-control" />
                </div>
              </div>
            </div>

            <div class="col-md-2 d-flex align-items-center">
              <button id="executeButton" class="btn btn-sm btn-info mt-5">
                <i class="fas fa-magnifying-glass me-2"></i>{{ _("Filter") }}
              </button>
            </div>
          </div>

          <table id="workerAreaList" class="table table-striped table-hover display nowrap" style="width:100%">
            <thead>
              <tr class="table-info">
                <th scope="col">{{ _("Area name") }}</th>
                <th scope="col">{{ _("Date and Hour") }}</th>
                <th scope="col">{{ _("sad") }}</th>
                <th scope="col">{{ _("fear") }}</th>
                <th scope="col">{{ _("angry") }}</th>
                <th scope="col">{{ _("happy") }}</th>
                <th scope="col">{{ _("disgust") }}</th>
                <th scope="col">{{ _("neutral") }}</th>
                <th scope="col">{{ _("surprise") }}</th>
              </tr>
            </thead>
            <tbody>
              {% for area, dates in area_emotions.items %}
                {% for date, hours in dates.items %}
                  {% for hour, emotions in hours.items %}
                    <tr>
                      <td>{{ area }}</td>
                      <td>{{ date }} {{ hour }}</td>
                      <td>{{ emotions.sad|default:0 }}</td>
                      <td>{{ emotions.fear|default:0 }}</td>
                      <td>{{ emotions.angry|default:0 }}</td>
                      <td>{{ emotions.happy|default:0 }}</td>
                      <td>{{ emotions.disgust|default:0 }}</td>
                      <td>{{ emotions.neutral|default:0 }}</td>
                      <td>{{ emotions.surprise|default:0 }}</td>
                    </tr>
                  {% endfor %}
                {% endfor %}
              {% empty %}
                <tr>
                  <td colspan="9" class="text-center bg-info">{{ _("No data available.") }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <div
          class="tab-pane fade" id="ex3-pills-2"
          role="tabpanel" aria-labelledby="ex3-tab-2">
          
          {# EMOCIONES POR TURNOS #}
          <div class="row mb-3">
            <div class="col-md-4 d-flex align-items-center">
              <div class="col">
                <label for="areaFilter" class="col-form-label me-2"><b style="color: #dc3545;">{{ _("Select work shift") }}:</b></label>
                <select id="areaFilter" class="form-control form-select" required>
                  <option value="" selected>---------</option>
                  {% for work_shift in work_shifts %}
                    <option value="{{ work_shift }}">{{ work_shift }}</option>
                  {% endfor %}
                </select>
              </div>
            </div>

            <div class="col-md-6 d-flex align-items-center">
              <div class="col">
                <label for="range" class="col-form-label me-2"><b style="color: #dc3545;">{{ _("Select date range") }}:</b></label>
                <div id="range" class="input-group">
                  <span class="input-group-text">Desde:</span>
                  <input type="date" name="start" class="form-control" />
                  <span class="input-group-text">Hasta:</span>
                  <input type="date" name="end" class="form-control" />
                </div>
              </div>
            </div>

            <div class="col-md-2 d-flex align-items-center">
              <button id="executeButton" class="btn btn-sm btn-info mt-5">
                <i class="fas fa-magnifying-glass me-2"></i>{{ _("Filter") }}
              </button>
            </div>
          </div>
          <table id="workShiftList" class="table table-striped table-hover display nowrap" style="width:100%">
            <thead>
              <tr class="table-info">
                <th scope="col">{{ _("Work shift name") }}</th>
                <th scope="col">{{ _("Date and Hour") }}</th>
                <th scope="col">{{ _("sad") }}</th>
                <th scope="col">{{ _("fear") }}</th>
                <th scope="col">{{ _("angry") }}</th>
                <th scope="col">{{ _("happy") }}</th>
                <th scope="col">{{ _("disgust") }}</th>
                <th scope="col">{{ _("neutral") }}</th>
                <th scope="col">{{ _("surprise") }}</th>
              </tr>
            </thead>
            <tbody>
              {% for shift, dates in work_shift_emotions.items %}
                {% for date, hours in dates.items %}
                    {% for hour, emotions in hours.items %}
                      <tr>
                        <td>{{ shift }}</td>
                        <td>{{ date }} {{ hour }}</td>
                        <td>{{ emotions.sad|default:0 }}</td>
                        <td>{{ emotions.fear|default:0 }}</td>
                        <td>{{ emotions.angry|default:0 }}</td>
                        <td>{{ emotions.happy|default:0 }}</td>
                        <td>{{ emotions.disgust|default:0 }}</td>
                        <td>{{ emotions.neutral|default:0 }}</td>
                        <td>{{ emotions.surprise|default:0 }}</td>
                      </tr>
                    {% endfor %}
                {% endfor %}
              {% empty %}
                <tr>
                  <td colspan="9" class="text-center bg-info">{{ _("No data available.") }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <div class="tab-pane fade" id="ex3-pills-3"
          role="tabpanel" aria-labelledby="ex3-tab-3">
          
          {# EMOCIONES POR HORAS #}
          <div class="row mb-3">
            <div class="col-md-6 d-flex align-items-center">
              <div class="col">
                <label for="range" class="col-form-label me-2"><b style="color: #dc3545;">{{ _("Select date time range") }}:</b></label>
                <div id="range" class="input-group">
                  <span class="input-group-text">Desde:</span>
                  <input type="date" name="start" class="form-control" />
                  <span class="input-group-text">Hasta:</span>
                  <input type="date" name="end" class="form-control" />
                </div>
              </div>
            </div>

            <div class="col-md-2 d-flex align-items-center">
              <button id="executeButton" class="btn btn-sm btn-info mt-5">
                <i class="fas fa-magnifying-glass me-2"></i>{{ _("Filter") }}
              </button>
            </div>
          </div>
          <table id="hoursList" class="table table-striped table-hover display nowrap" style="width:100%">
            <thead>
              <tr class="table-info">
                <th scope="col">{{ _("Date and Hour") }}</th>
                <th scope="col">{{ _("sad") }}</th>
                <th scope="col">{{ _("fear") }}</th>
                <th scope="col">{{ _("angry") }}</th>
                <th scope="col">{{ _("happy") }}</th>
                <th scope="col">{{ _("disgust") }}</th>
                <th scope="col">{{ _("neutral") }}</th>
                <th scope="col">{{ _("surprise") }}</th>
              </tr>
            </thead>
            <tbody>
              {% for date, hours in hourly_emotions.items %}
                {% for hour, emotions in hours.items %}
                  <tr>
                    <td>{{ date }} {{ hour }}</td>
                    <td>{{ emotions.sad|default:0 }}</td>
                    <td>{{ emotions.fear|default:0 }}</td>
                    <td>{{ emotions.angry|default:0 }}</td>
                    <td>{{ emotions.happy|default:0 }}</td>
                    <td>{{ emotions.disgust|default:0 }}</td>
                    <td>{{ emotions.neutral|default:0 }}</td>
                    <td>{{ emotions.surprise|default:0 }}</td>
                  </tr>
                {% endfor %}
              {% empty %}
                <tr>
                  <td colspan="8" class="text-center bg-info">{{ _("No data available.") }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <div class="tab-pane fade" id="ex3-pills-4"
          role="tabpanel" aria-labelledby="ex3-tab-4">

          {# EMOCIONES POR EMPLEADO #}
          <div class="row mb-3">
            <div class="col-md-4 d-flex align-items-center">
              <div class="col">
                <label for="employee-select" class="col-form-label"><b style="color: #dc3545;">{{ _("Select employee") }}:</b></label><br>

                <!--
                <select id="areaFilter" class="form-control form-select" required>
                  <option value="" selected>---------</option>
                  {% for work_shift in work_shifts %}
                    <option value="{{ work_shift }}">{{ work_shift }}</option>
                  {% endfor %}
                </select>
                -->

                
                  <div id="employee-select"></div>
                

              </div>
            </div>

            <div class="col-md-6 d-flex align-items-center">
              <div class="col">
                <label for="range" class="col-form-label me-2"><b style="color: #dc3545;">{{ _("Select date range") }}:</b></label>
                <div id="range" class="input-group">
                  <span class="input-group-text">Desde:</span>
                  <input type="date" name="start" class="form-control" />
                  <span class="input-group-text">Hasta:</span>
                  <input type="date" name="end" class="form-control" />
                </div>
              </div>
            </div>

            <div class="col-md-2 d-flex align-items-center">
              <button id="executeButton" class="btn btn-sm btn-info mt-5">
                <i class="fas fa-magnifying-glass me-2"></i>{{ _("Filter") }}
              </button>
            </div>
          </div>
          <table id="employeeList" class="table table-striped table-hover display nowrap" style="width:100%">
            <thead>
              <tr class="table-info">
                <th scope="col">{{ _("Employee")}}</th>
                <th scope="col">{{ _("Date and Hour") }}</th>
                <th scope="col">{{ _("sad") }}</th>
                <th scope="col">{{ _("fear") }}</th>
                <th scope="col">{{ _("angry") }}</th>
                <th scope="col">{{ _("happy") }}</th>
                <th scope="col">{{ _("disgust") }}</th>
                <th scope="col">{{ _("neutral") }}</th>
                <th scope="col">{{ _("surprise") }}</th>
              </tr>
            </thead>
            <tbody>
              {% for employee, dates in employee_hourly_emotions.items %}
                {% for date, hours in dates.items %}
                  {% for hour, emotions in hours.items %}
                    <tr>
                      <td>{{ employee }}</td>
                      <td>{{ date }} {{ hour }}</td>
                      <td>{{ emotions.sad|default:0 }}</td>
                      <td>{{ emotions.fear|default:0 }}</td>
                      <td>{{ emotions.angry|default:0 }}</td>
                      <td>{{ emotions.happy|default:0 }}</td>
                      <td>{{ emotions.disgust|default:0 }}</td>
                      <td>{{ emotions.neutral|default:0 }}</td>
                      <td>{{ emotions.surprise|default:0 }}</td>
                    </tr>
                  {% endfor %}
                {% endfor %}
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
      <!-- Pills content -->
    </div>
  </div>
</section>
{% endblock content %}

{% block extra_js %}
  <script src="{% static 'vendor/virtual-select/dist/virtual-select.min.js' %}"></script>

  <script>
    $("form select").addClass("form-select");
    

    VirtualSelect.init({
      ele: '#employee-select',
      options: [
        
      ],
    });

    document.addEventListener('DOMContentLoaded', function () {
      
    })
  </script>
{% endblock extra_js %}
